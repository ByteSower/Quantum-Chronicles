import{r as n,b as u,c as p,j as e}from"./index-DQ_Gbl6s.js";const H=({isVisible:m,onSubmit:v,onDismiss:j,category:a,milestone:s,title:y,description:N,quickOptions:l=[]})=>{const[r,c]=n.useState(0),[b,f]=n.useState(""),[x,g]=n.useState(!1),[o,k]=n.useState(""),[d,w]=n.useState(!1);n.useEffect(()=>{m&&(u.trackFeedbackEvent("feedback_prompt_shown",{category:a,milestone:s}),p.announce(`Feedback prompt appeared for ${a}`,"polite"))},[m,a,s]);const S=async()=>{if(r===0&&!o)return;g(!0);const t={rating:r,comment:b.trim()||o,category:a,milestone:s,timestamp:Date.now()};try{u.trackFeedbackEvent("feedback_response_submitted",{category:a,milestone:s,rating:r,hasComment:!!t.comment,quickOption:o}),v(t),c(0),f(""),k(""),w(!1),p.announce("Thank you for your feedback!","polite")}catch(i){console.error("Failed to submit feedback:",i),p.announce("Feedback submission failed. Please try again.","assertive")}finally{g(!1)}},h=()=>{u.trackFeedbackEvent("feedback_prompt_dismissed",{category:a,milestone:s}),j()},F=t=>{k(t),u.trackFeedbackEvent("feedback_quick_option_selected",{category:a,milestone:s,quickOption:t})},C=()=>e.jsx("div",{className:"flex justify-center gap-1 mb-4",role:"radiogroup","aria-label":"Rate your experience from 1 to 5 stars",children:[1,2,3,4,5].map(t=>e.jsx("button",{onClick:()=>c(t),onKeyDown:i=>{i.key==="ArrowLeft"&&t>1&&c(t-1),i.key==="ArrowRight"&&t<5&&c(t+1)},className:`text-2xl transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:ring-opacity-50 rounded ${t<=r?"text-yellow-400 hover:text-yellow-300":"text-gray-600 hover:text-gray-500"}`,"aria-label":`${t} star${t>1?"s":""}`,"aria-pressed":t<=r,role:"radio","aria-checked":t===r,children:"â˜…"},t))}),D=()=>{switch(a){case"onboarding":return"How was the getting started experience?";case"story":return"How are you enjoying the story so far?";case"choice":return"How was that decision-making experience?";case"interaction":return"How did that interaction feel?";case"overall":return"How would you rate your overall experience?";default:return"How was your experience?"}},_=()=>{switch(a){case"onboarding":return"Your feedback helps us improve the introduction for new users.";case"story":return"Tell us what you think about the narrative and flow.";case"choice":return"Help us understand how choice interactions feel.";case"interaction":return"Your input helps us refine the user experience.";case"overall":return"Share your thoughts on the overall experience.";default:return"Your feedback is valuable to us."}};return m?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",role:"dialog","aria-modal":"true","aria-labelledby":"feedback-title","aria-describedby":"feedback-description",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 transition-opacity duration-300",onClick:h,"aria-hidden":"true"}),e.jsxs("div",{className:"relative bg-gradient-to-br from-slate-800 to-slate-900 border border-indigo-500/30 rounded-xl shadow-2xl p-6 max-w-md w-full mx-4 transform transition-all duration-300",children:[e.jsx("button",{onClick:h,className:"absolute top-4 right-4 text-slate-400 hover:text-white transition-colors duration-200","aria-label":"Close feedback prompt",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{id:"feedback-title",className:"text-xl font-bold mb-2 bg-gradient-to-r from-indigo-300 to-purple-300 bg-clip-text text-transparent",children:y||D()}),e.jsx("p",{id:"feedback-description",className:"text-slate-300 text-sm",children:N||_()})]}),l.length>0&&!d&&e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-slate-300 text-sm mb-3",children:"Quick feedback:"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:l.map((t,i)=>e.jsx("button",{onClick:()=>F(t),className:`p-3 rounded-lg text-sm text-left transition-all duration-200 ${o===t?"bg-indigo-600 text-white border border-indigo-500":"bg-slate-700/50 text-slate-300 hover:bg-slate-600/50 border border-slate-600/50"}`,"aria-pressed":o===t,children:t},i))})]}),(d||l.length===0)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-slate-300 text-sm mb-3 text-center",children:"Rate your experience:"}),C()]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"feedback-comment",className:"block text-slate-300 text-sm mb-2",children:"Additional comments (optional):"}),e.jsx("textarea",{id:"feedback-comment",value:b,onChange:t=>f(t.target.value),placeholder:"Tell us more about your experience...",className:"w-full p-3 bg-slate-700/50 border border-slate-600/50 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:ring-opacity-50 resize-none",rows:3,maxLength:500}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:[b.length,"/500 characters"]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[!d&&l.length>0&&e.jsx("button",{onClick:()=>w(!0),className:"text-indigo-300 hover:text-indigo-200 text-sm transition-colors duration-200",children:"Give detailed feedback"}),e.jsxs("div",{className:"flex gap-3 ml-auto",children:[e.jsx("button",{onClick:h,className:"px-4 py-2 text-sm text-slate-400 hover:text-white transition-colors duration-200",disabled:x,children:"Skip"}),e.jsx("button",{onClick:S,disabled:x||r===0&&!o&&(d||l.length===0),className:"px-6 py-2 text-sm bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white rounded-lg font-semibold transition-all duration-300 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Submitting...":"Submit Feedback"})]})]})]})]}):null};export{H as default};
